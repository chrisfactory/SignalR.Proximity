<ResourceDictionary
    x:Class="Samples.Framework.WPF.Generic"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:Samples.Framework.WPF">
    <local:NullToVisibilityConverter x:Key="NullToVisibility"/>
    <Style TargetType="{x:Type local:UserViewer}">
        <Style.Setters>
            <Setter Property="Background" Value="Black"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="1"/> 
            <Setter Property="Margin" Value="10"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type local:UserViewer}">

                        <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Height="{TemplateBinding Height}" >
                            <Grid >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock 
                                    Text="{TemplateBinding UserName}" 
                                    Foreground="White" 
                                    Background="Red" 
                                    HorizontalAlignment="Left" 
                                    VerticalAlignment="Stretch"
                                    TextAlignment="Center"
                                    FontSize="16"
                                    FontWeight="DemiBold" Padding="5" Margin="0,0,10,0">
                                    <TextBlock.LayoutTransform>
                                        <RotateTransform Angle="-90" />
                                    </TextBlock.LayoutTransform>
                                </TextBlock>
                                <Image Grid.Column="1" Source="{TemplateBinding UserImageSource}" Height="60" Width="60"  VerticalAlignment="Center" >
                                    <Image.Clip>
                                        <GeometryGroup>
                                            <EllipseGeometry RadiusX="30" RadiusY="30" Center="30,30"/>
                                        </GeometryGroup>
                                    </Image.Clip>
                                </Image>
                                <ContentControl Content="{TemplateBinding Content}"  Grid.Column="2" HorizontalAlignment="Left" Margin="10,0"/>

                                <Border DataContext="{TemplateBinding UserMessage}" Visibility="{Binding Path=.,Converter={StaticResource NullToVisibility}}" Grid.Column="3" BorderBrush="#FF1BD1EE" Width="120" HorizontalAlignment="Right" BorderThickness="1" Margin="0,30,5,5" CornerRadius="0,5,5,5">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                  
                                        <TextBlock Text="{Binding From}" Foreground="Gray" FontSize="12" FontWeight="DemiBold"/>
                                        <TextBlock Text="{Binding Message}" Foreground="White" Grid.Row="1"/>

                                        <Viewbox Height="40" Width="40" HorizontalAlignment="Left" Margin="-38,-52,0,0">
                                            <Grid>
                                                <Grid Name="backgroundGrid" Width="256" Height="256" Visibility="Collapsed" />
                                                <Path Data="M22.900024,11.400001C21.600037,11.400001 20.600037,12.400001 20.600037,13.700004 20.600037,14.99999 21.600037,15.999989 22.900024,15.999989 24.200012,15.999989 25.200012,14.99999 25.200012,13.700004 25.100037,12.499992 24.100037,11.400001 22.900024,11.400001z M16,11.400001C14.700012,11.400001 13.700012,12.400001 13.700012,13.700004 13.700012,14.99999 14.700012,15.999989 16,15.999989 17.299988,15.999989 18.299988,14.99999 18.299988,13.700004 18.299988,12.499992 17.299988,11.400001 16,11.400001z M9.1000366,11.400001C7.7999878,11.400001 6.7999878,12.400001 6.7999878,13.700004 6.7999878,14.99999 7.7999878,15.999989 9.1000366,15.999989 10.400024,15.999989 11.400024,14.99999 11.400024,13.700004 11.400024,12.499992 10.400024,11.400001 9.1000366,11.400001z M16,0C24.799988,7.0681381E-08 32,5.6000027 32,12.599997 32,19.499988 24.799988,25.199996 16,25.199996 13.900024,25.199996 11.900024,24.899978 10.100037,24.300002 8.2000122,25.699996 5.1000366,27.8 2.1000366,27.8 3.7000122,26.300002 4.2000122,23.39998 4.2999878,21.199998 1.6000366,18.899981 0,15.899999 0,12.599997 0,5.6000027 7.2000122,7.0681381E-08 16,0z" Stretch="Uniform" Fill="#FF1BD1EE" Width="138" Height="138" Margin="0,0,0,0" RenderTransformOrigin="0.5,0.5">
                                                    <Path.RenderTransform>
                                                        <TransformGroup>
                                                            <TransformGroup.Children>
                                                                <RotateTransform Angle="0" />
                                                                <ScaleTransform ScaleX="-1" ScaleY="1" />
                                                            </TransformGroup.Children>
                                                        </TransformGroup>
                                                    </Path.RenderTransform>
                                                </Path>
                                            </Grid>
                                        </Viewbox>
                                    </Grid>
                                 
                                </Border>
                                
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style.Setters>
  
    </Style>
</ResourceDictionary>
